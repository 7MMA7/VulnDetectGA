{"idx": 207150, "project": "squirrel", "commit_id": "a6413aa690e0bdfef648c68693349a7b878fe60d", "project_url": "https://github.com/albertodemichelis/squirrel", "commit_url": "https://github.com/albertodemichelis/squirrel/commit/a6413aa690e0bdfef648c68693349a7b878fe60d", "commit_message": "fix in thread.call", "target": 1, "func": "static SQInteger thread_call(HSQUIRRELVM v)\n{\n    SQObjectPtr o = stack_get(v,1);\n    if(sq_type(o) == OT_THREAD) {\n        SQInteger nparams = sq_gettop(v);\n        _thread(o)->Push(_thread(o)->_roottable);\n        for(SQInteger i = 2; i<(nparams+1); i++)\n            sq_move(_thread(o),v,i);\n        if(SQ_SUCCEEDED(sq_call(_thread(o),nparams,SQTrue,SQTrue))) {\n            sq_move(v,_thread(o),-1);\n            sq_pop(_thread(o),1);\n            return 1;\n        }\n        v->_lasterror = _thread(o)->_lasterror;\n        return SQ_ERROR;\n    }\n    return sq_throwerror(v,_SC(\"wrong parameter\"));\n}", "func_hash": 39783972208477930534182111058478291044, "file_name": "sqbaselib.cpp", "file_hash": 22214130882110251892898581176850711195, "cwe": ["CWE-703"], "cve": "CVE-2022-30292", "cve_desc": "Heap-based buffer overflow in sqbaselib.cpp in SQUIRREL 3.2 due to lack of a certain sq_reservestack call.", "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2022-30292", "file_path": "squirrel/sqbaselib.cpp"}
{"idx": 393528, "project": "squirrel", "commit_id": "a6413aa690e0bdfef648c68693349a7b878fe60d", "project_url": "https://github.com/albertodemichelis/squirrel", "commit_url": "https://github.com/albertodemichelis/squirrel/commit/a6413aa690e0bdfef648c68693349a7b878fe60d", "commit_message": "fix in thread.call", "target": 0, "func": "static SQInteger thread_call(HSQUIRRELVM v)\n{\n    SQObjectPtr o = stack_get(v,1);\n    if(sq_type(o) == OT_THREAD) {\n        SQInteger nparams = sq_gettop(v);\n        sq_reservestack(_thread(o), nparams + 3);\n        _thread(o)->Push(_thread(o)->_roottable);\n        for(SQInteger i = 2; i<(nparams+1); i++)\n            sq_move(_thread(o),v,i);\n        if(SQ_SUCCEEDED(sq_call(_thread(o),nparams,SQTrue,SQTrue))) {\n            sq_move(v,_thread(o),-1);\n            sq_pop(_thread(o),1);\n            return 1;\n        }\n        v->_lasterror = _thread(o)->_lasterror;\n        return SQ_ERROR;\n    }\n    return sq_throwerror(v,_SC(\"wrong parameter\"));\n}", "func_hash": 185870701968227218426869749475686341047, "file_name": "sqbaselib.cpp", "file_hash": 167918424394936848193603192917033144376, "cwe": ["CWE-703"], "cve": "CVE-2022-30292", "cve_desc": "Heap-based buffer overflow in sqbaselib.cpp in SQUIRREL 3.2 due to lack of a certain sq_reservestack call.", "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2022-30292", "file_path": "squirrel/sqbaselib.cpp"}
