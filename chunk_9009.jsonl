{"idx": 205734, "project": "rizin", "commit_id": "38d8006cd609ac75de82b705891d3508d2c218d5", "project_url": "https://github.com/rizinorg/rizin", "commit_url": "https://github.com/rizinorg/rizin/commit/38d8006cd609ac75de82b705891d3508d2c218d5", "commit_message": "fix #2963 - oob write (1 byte) in pyc/marshal.c", "target": 1, "func": "static pyc_object *get_complex_object(RzBinPycObj *pyc, RzBuffer *buffer) {\n\tpyc_object *ret = NULL;\n\tbool error = false;\n\tut32 size = 0;\n\tut32 n1 = 0;\n\tut32 n2 = 0;\n\n\tret = RZ_NEW0(pyc_object);\n\tif (!ret) {\n\t\treturn NULL;\n\t}\n\n\tif ((pyc->magic_int & 0xffff) <= 62061) {\n\t\tn1 = get_ut8(buffer, &error);\n\t} else {\n\t\tn1 = get_st32(buffer, &error);\n\t}\n\tif (error) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tut8 *s1 = malloc(n1 + 1);\n\tif (!s1) {\n\t\treturn NULL;\n\t}\n\t/* object contain string representation of the number */\n\tsize = rz_buf_read(buffer, s1, n1);\n\tif (size != n1) {\n\t\tRZ_FREE(s1);\n\t\tRZ_FREE(ret);\n\t\treturn NULL;\n\t}\n\ts1[n1] = '\\0';\n\n\tif ((pyc->magic_int & 0xffff) <= 62061) {\n\t\tn2 = get_ut8(buffer, &error);\n\t} else\n\t\tn2 = get_st32(buffer, &error);\n\tif (error) {\n\t\treturn NULL;\n\t}\n\tut8 *s2 = malloc(n2 + 1);\n\tif (!s2) {\n\t\treturn NULL;\n\t}\n\t/* object contain string representation of the number */\n\tsize = rz_buf_read(buffer, s2, n2);\n\tif (size != n2) {\n\t\tRZ_FREE(s1);\n\t\tRZ_FREE(s2);\n\t\tRZ_FREE(ret);\n\t\treturn NULL;\n\t}\n\ts2[n2] = '\\0';\n\n\tret->type = TYPE_COMPLEX;\n\tret->data = rz_str_newf(\"%s+%sj\", s1, s2);\n\tRZ_FREE(s1);\n\tRZ_FREE(s2);\n\tif (!ret->data) {\n\t\tRZ_FREE(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}", "func_hash": 339221193473342829219562491579233996408, "file_name": "marshal.c", "file_hash": 62206307764182880841643297994357401149, "cwe": ["CWE-787"], "cve": "CVE-2022-36040", "cve_desc": "Rizin is a UNIX-like reverse engineering framework and command-line toolset. Versions 0.4.0 and prior are vulnerable to an out-of-bounds write when getting data from PYC(python) files. A user opening a malicious PYC file could be affected by this vulnerability, allowing an attacker to execute code on the user's machine. Commit number 68948017423a12786704e54227b8b2f918c2fd27 contains a patch.", "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2022-36040", "file_path": "librz/bin/format/pyc/marshal.c"}
{"idx": 371185, "project": "rizin", "commit_id": "38d8006cd609ac75de82b705891d3508d2c218d5", "project_url": "https://github.com/rizinorg/rizin", "commit_url": "https://github.com/rizinorg/rizin/commit/38d8006cd609ac75de82b705891d3508d2c218d5", "commit_message": "fix #2963 - oob write (1 byte) in pyc/marshal.c", "target": 0, "func": "static pyc_object *get_complex_object(RzBinPycObj *pyc, RzBuffer *buffer) {\n\tpyc_object *ret = NULL;\n\tbool error = false;\n\tut32 n1 = 0;\n\tut32 n2 = 0;\n\n\tret = RZ_NEW0(pyc_object);\n\tif (!ret) {\n\t\treturn NULL;\n\t}\n\n\tif ((pyc->magic_int & 0xffff) <= 62061) {\n\t\tn1 = get_ut8(buffer, &error);\n\t} else {\n\t\tn1 = get_st32(buffer, &error);\n\t}\n\tif (error || UT32_ADD_OVFCHK(n1, 1)) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tut8 *s1 = malloc(n1 + 1);\n\tif (!s1) {\n\t\treturn NULL;\n\t}\n\t/* object contain string representation of the number */\n\tif (rz_buf_read(buffer, s1, n1) != n1) {\n\t\tRZ_FREE(s1);\n\t\tRZ_FREE(ret);\n\t\treturn NULL;\n\t}\n\ts1[n1] = '\\0';\n\n\tif ((pyc->magic_int & 0xffff) <= 62061) {\n\t\tn2 = get_ut8(buffer, &error);\n\t} else {\n\t\tn2 = get_st32(buffer, &error);\n\t}\n\tif (error || UT32_ADD_OVFCHK(n2, 1)) {\n\t\treturn NULL;\n\t}\n\tut8 *s2 = malloc(n2 + 1);\n\tif (!s2) {\n\t\treturn NULL;\n\t}\n\t/* object contain string representation of the number */\n\tif (rz_buf_read(buffer, s2, n2) != n2) {\n\t\tRZ_FREE(s1);\n\t\tRZ_FREE(s2);\n\t\tRZ_FREE(ret);\n\t\treturn NULL;\n\t}\n\ts2[n2] = '\\0';\n\n\tret->type = TYPE_COMPLEX;\n\tret->data = rz_str_newf(\"%s+%sj\", s1, s2);\n\tRZ_FREE(s1);\n\tRZ_FREE(s2);\n\tif (!ret->data) {\n\t\tRZ_FREE(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}", "func_hash": 99548148027118090642314481180057035575, "file_name": "marshal.c", "file_hash": 23141269581653768082758645127626248017, "cwe": ["CWE-787"], "cve": "CVE-2022-36040", "cve_desc": "Rizin is a UNIX-like reverse engineering framework and command-line toolset. Versions 0.4.0 and prior are vulnerable to an out-of-bounds write when getting data from PYC(python) files. A user opening a malicious PYC file could be affected by this vulnerability, allowing an attacker to execute code on the user's machine. Commit number 68948017423a12786704e54227b8b2f918c2fd27 contains a patch.", "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2022-36040", "file_path": "librz/bin/format/pyc/marshal.c"}
{"idx": 205736, "project": "linux", "commit_id": "775c5033a0d164622d9d10dd0f0a5531639ed3ed", "project_url": "https://github.com/torvalds/linux", "commit_url": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=775c5033a0d164622d9d10dd0f0a5531639ed3ed", "commit_message": "fuse: fix live lock in fuse_iget()\n\nCommit 5d069dbe8aaf (\"fuse: fix bad inode\") replaced make_bad_inode()\nin fuse_iget() with a private implementation fuse_make_bad().\n\nThe private implementation fails to remove the bad inode from inode\ncache, so the retry loop with iget5_locked() finds the same bad inode\nand marks it bad forever.\n\nkmsg snip:\n\n[ ] rcu: INFO: rcu_sched self-detected stall on CPU\n...\n[ ]  ? bit_wait_io+0x50/0x50\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ? find_inode.isra.32+0x60/0xb0\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ilookup5_nowait+0x65/0x90\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ilookup5.part.36+0x2e/0x80\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ? fuse_inode_eq+0x20/0x20\n[ ]  iget5_locked+0x21/0x80\n[ ]  ? fuse_inode_eq+0x20/0x20\n[ ]  fuse_iget+0x96/0x1b0\n\nFixes: 5d069dbe8aaf (\"fuse: fix bad inode\")\nCc: stable@vger.kernel.org # 5.10+\nSigned-off-by: Amir Goldstein <amir73il@gmail.com>\nSigned-off-by: Miklos Szeredi <mszeredi@redhat.com>", "target": 1, "func": "static inline void fuse_make_bad(struct inode *inode)\n{\n\tset_bit(FUSE_I_BAD, &get_fuse_inode(inode)->state);\n}", "func_hash": 47372311033330775185323042617136550109, "file_name": "fuse_i.h", "file_hash": 275513758194031113369959181365685841551, "cwe": ["CWE-834"], "cve": "CVE-2021-28950", "cve_desc": "An issue was discovered in fs/fuse/fuse_i.h in the Linux kernel before 5.11.8. A \"stall on CPU\" can occur because a retry loop continually finds the same bad inode, aka CID-775c5033a0d1.", "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2021-28950", "file_path": "fs/fuse/fuse_i.h"}
{"idx": 371226, "project": "linux", "commit_id": "775c5033a0d164622d9d10dd0f0a5531639ed3ed", "project_url": "https://github.com/torvalds/linux", "commit_url": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=775c5033a0d164622d9d10dd0f0a5531639ed3ed", "commit_message": "fuse: fix live lock in fuse_iget()\n\nCommit 5d069dbe8aaf (\"fuse: fix bad inode\") replaced make_bad_inode()\nin fuse_iget() with a private implementation fuse_make_bad().\n\nThe private implementation fails to remove the bad inode from inode\ncache, so the retry loop with iget5_locked() finds the same bad inode\nand marks it bad forever.\n\nkmsg snip:\n\n[ ] rcu: INFO: rcu_sched self-detected stall on CPU\n...\n[ ]  ? bit_wait_io+0x50/0x50\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ? find_inode.isra.32+0x60/0xb0\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ilookup5_nowait+0x65/0x90\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ilookup5.part.36+0x2e/0x80\n[ ]  ? fuse_init_file_inode+0x70/0x70\n[ ]  ? fuse_inode_eq+0x20/0x20\n[ ]  iget5_locked+0x21/0x80\n[ ]  ? fuse_inode_eq+0x20/0x20\n[ ]  fuse_iget+0x96/0x1b0\n\nFixes: 5d069dbe8aaf (\"fuse: fix bad inode\")\nCc: stable@vger.kernel.org # 5.10+\nSigned-off-by: Amir Goldstein <amir73il@gmail.com>\nSigned-off-by: Miklos Szeredi <mszeredi@redhat.com>", "target": 0, "func": "static inline void fuse_make_bad(struct inode *inode)\n{\n\tremove_inode_hash(inode);\n\tset_bit(FUSE_I_BAD, &get_fuse_inode(inode)->state);\n}", "func_hash": 322879755488186541223674702992331788623, "file_name": "fuse_i.h", "file_hash": 37876063683408329716495167282300176867, "cwe": ["CWE-834"], "cve": "CVE-2021-28950", "cve_desc": "An issue was discovered in fs/fuse/fuse_i.h in the Linux kernel before 5.11.8. A \"stall on CPU\" can occur because a retry loop continually finds the same bad inode, aka CID-775c5033a0d1.", "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2021-28950", "file_path": "fs/fuse/fuse_i.h"}
